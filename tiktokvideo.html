<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='UTF-8'>
<title>TikTok Video</title>
<script src="https://cdn.tailwindcss.com"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc } 
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDTIzoJlvrr0mYxwx82cQ9JJn8rXrMEy7JA",
  authDomain: "reps-central.firebaseapp.com",
  projectId: "reps-central",
  storageBucket: "reps-central.firebasestorage.app",
  messagingSenderId: "812299387060",
  appId: "1:812299387060:web:1c93d1e7bf30b565536d7e1",
  measurementId: "G-8T7F9F1FZ9"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const params = new URLSearchParams(location.search);
const videoID = params.get("id");

async function loadVideo() {
  const snap = await getDoc(doc(db, "tiktokvideos", videoID));
  if (!snap.exists()) return;

  const d = snap.data();
  document.getElementById("videoPlayer").src = d.videourl;

  const list = document.getElementById("itemsList");
  list.innerHTML = "";

  for (const name of d.items || []) {
    const itemSnap = await getDoc(doc(db, "tiktokitems", name));
    if (!itemSnap.exists()) continue;

    const it = itemSnap.data();
    const div = document.createElement("div");
    div.className = "bg-white rounded-xl shadow p-4 flex gap-4";

    div.innerHTML = `
      <img src="${it.image}" class="w-24 h-24 rounded object-cover">
      <div>
        <h3 class="font-bold">${it.title}</h3>
        <p class="text-sm text-gray-600">Â£${it.price}</p>
      </div>
    `;
    list.appendChild(div);
  }
}
loadVideo();
</script>
</head>

<body class="bg-gray-50 p-6 font-sans">
<header class="flex justify-between items-center mb-8 pb-4 rounded-b-xl shadow px-4 pt-4"
 style="background:linear-gradient(135deg,#ffffff 60%,#e0f7fa 100%)">
 <img src="https://raw.githubusercontent.com/MinerBlox/website/refs/heads/main/images/mainlogo.png" class="h-10">
</header>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-10 max-w-5xl mx-auto">
  <video id="videoPlayer" controls class="rounded-xl shadow w-full max-w-sm bg-black"></video>

  <div>
    <h2 class="font-bold text-xl mb-4">Items in this Video</h2>
    <div id="itemsList" class="space-y-4"></div>
  </div>
</div>

</body>
</html>
